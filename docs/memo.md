# Javascriptのメモ

## 基本的な書き方・ルール

### 記法

* `<script>`要素の中にコードを記述していく。
* 基本的には `</body>`閉じタグの直前に書く。
  * `</body>`タグの直前に記載することで、ページの表示後にスクリプトを読み込むのでページ表示の高速化につながる。
* 文の末尾には `;` （セミコロン）を付ける。
  * 付けなくても動くが、非推奨。
* 大文字と小文字は厳密に区別される。
* コメントは３つの記法が可能。
  * `// comment` ： 単一行コメント。
  * `/* comment */` ： 複数行コメント。
  * `/** comment */` ： ドキュメンテーションコメント。javadoc的なやつ。
  * 基本的には単一行コメントを優先的に使用する。

```html
<body>
    <script type="text/javascript">
        window.alert("Hello World");
    </script>
</body>
```

* Javascriptを外部ファイルにする場合、`<script>`タグの `src` 属性にjavascriptファイルのパスを記載する。
* 外部ファイルの読み込みを行う場合、`<script>`要素内のコードは無視される。

```html
<body>
    <script type="text/javascript" src="./javascript/common.js">
        window.alert("Hello World"); // これは無視される
    </script>
</body>
```

* Javascriptが無効な場合に代替コンテンツを表示させるには、`<noscript>` タグを用いる。

```html
<body>
    <noscript>Javascriptが有効ではありません。</noscript>
</body>
```

* アンカータグにスクリプトを埋め込むこともできる。
* その場合、「`Javascript:~`」の形式で記述する。
* 以下の例だと、aタグの`href`属性にスクリプトを埋め込んでおり、リンクをクリックする度にダイアログが表示される。

```html
<a href="Javascript: window.alert('Hello World');" >ダイアログ表示</a>
```

### 変数・定数

* 変数の宣言は `var 変数名 [=初期値];` で行う。
* 複数の変数を `,` （カンマ）区切りで記述することもできる。

```javascript
var msg; // msgという変数を定義
var x, y; // 複数定義
var hello = 'Hello World'; // 変数の定義と同時に、初期値を設定。
```

* 変数を宣言する命令として `var` 以外に、`let` 命令が使用できる。
* `let`命令は、ES2015から追加された。
* `var` との違いは以下。
  * 変数名の重複を許可しない。
  * ブロックスコープを認識する。

```javascript
// varの場合、変数名の重複は許可されている。
var x = 'hello';
var x = 'world';

// letの場合、変数目の重複は許可されない。
let msg = 'hello';
let msg = 'world'; // 重複ダメ、ぜったい。
```

ブロックスコープについては、あとで説明。<br/>
とりあえず、`var` よりも「変数の有効範囲を細かく管理できる」と理解する。

* 定数を定義する場合には `const` 命令を利用する。
* 構文は変数の定義時と同じように、`const 定数名 = 値;` で行う。

```javascript
const TAX = 1.08;
```

### データ型

Javascriptの主なデータ型は以下。

* 基本型
  * 数値型：number
  * 文字列型：string ・・・ シングル or ダブルクウォートで囲まれた文字
  * 真偽型：boolean ・・・ true / false
  * シンボル型：symbol
  * 特殊型：null / undefined ・・・ 値が空、または未定義
* 参照型
  * 配列：array ・・・ 普通の配列
  * オブジェクト：object ・・・ 連想配列
  * 関数：function

JavascriptはJavaやScalaなどのように静的型付け言語ではないため、データ型を意識しなくてもいい。<br/>
そのため、以下のようなコードもエラーにならない。

```javascript
var value = 'hello';
value = 10;
```

#### リテラル

##### 数値リテラル

| 進法 | 記載方法例 | prefix |
|------|---------|---------|
| 10   | `10`    | -       |
| 16   | `0xFF`  | `0x`    |
| 8    | `0o67`  | `0o`    |
| 2    | `0b101` | `0b`    |

##### 文字リテラル

文字リテラルは

* シングルクォート（`'`）
* ダブルクウォート（`"`）

で囲んだ文字。

```javascript
// 文字リテラル
'Hello World';
"Hello World";
```

エスケープシーケンスは、他の言語と同じ。<br/>
「バックスラッシュ（`\`） + 文字」で表現する。

##### テンプレート文字

javascriptでは「テンプレート文字」が利用できる。

* 文字列へ変数を埋め込むことができる。
* 複数行にまたがる文字列。

以下のような使い方ができる。

```javascript
var name = "田中";
var message = `こんにちは、${name}さん。
今日は暑いですね。`;
console.log(message);
```

テンプレート文字内では改行はそのまま改行として扱われる。<br/>
Scalaでいう、生文字リテラル。

##### 配列リテラル

カンマ（`,`）区切りの値をブラケット（`[...]`）でくくった形式で表現する。

```javascript
[`Javascript`, 'Java', 'Scala', 'C#']
```

配列へのアクセスはインデックス番号をキーとする。<br/>

```javascript
var data = ["a", "b", "c"];
console.log(data[0]); // 実行結果：a
```

入れ子になっている場合も同様。

```javascript
var data = ["a", ["b", "c"], "d"];
console.log(data[1][1]); // 実行結果：c
```

##### オブジェクトリテラル

名前をキーにアクセスできる配列。<br/>
連想配列にあたる。

オブジェクト内の個々の要素は **プロパティ** と呼ぶ。<br/>
プロパティには文字列や数値などに加え、関数を格納することも出来る。<br/>
プロパティとして格納した関数を **メソッド** と呼ぶ。

オブジェクトリテラルの記載は以下の通り。

```javascript
var obj = {x:1, y:2, z:3};
console.log(obj.x);    // 結果：1
console.log(obj['x']); // 結果：1
```

配列はブラケット(`[]`)で囲っているのに対して、オブジェクトは中括弧(`{}`)で囲う。<br/>
また、プロパティへのアクセスはドット演算子かブラケット構文による２つの方法がある。

ドット演算子でアクセスする場合には、プロパティ名は識別子としてみなされるので `obj.123` のような名前は使用できない。<br/>
しかしブラケット構文だとプロパティ名は文字列として指定するので、`obj['123']` はOK。

##### 関数リテラル

後日記載


##### 未定義値

未定義値（`undefined`)は、ある変数の値が定義されていないことを表す値。<br/>
以下のようなケースで返される。
 
* ある変数が宣言済みであるが、値が与えられていない。
* 未定義のプロパティを参照しようとした場合。
* 関数で値が返却されなかった。

```javascript
var x;
var obj = { a: 1234 };
console.log(x);      // 結果：undefined (値が設定されていない）
console.log(obj.b);  // 結果：undefined (プロパティが存在しない)
```

##### null

未定義値の他に、該当する値がないことを表す **null** 値が存在している。<br/>
`undefined` は *定義されていない（参照することを想定していない）* であるのに対し、
`null` は **空である** ことを表す。

意図して空であることを表す場合には`null`を使用し、そうでなければ`undefined`を使用する。
